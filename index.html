<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Game Nhay Lau</title>
    <style>
        *{
            box-sizing: border-box;
            padding:0px;
        }
        .MainBox {
            line-height: 0;
            width:800px;
            height:600px;
            margin: 0 auto;
            background-color: black;
        }
         canvas{
            height:600px;
            width:800px;
            position: absolute;
        }
        #Mainlayer{
            z-index: 1;
        } 
        #BackgroundLayer{
            z-index: 0;
        } 
    </style>
</head>
<body>
    <div class="MainBox">
        <canvas id="Mainlayer"></canvas>
        <canvas id="BackgroundLayer"></canvas>
   

    </div>
    <script src="background.js"></script>
    <!-- <script src="Object.js"></script> -->
    
    <script>
    let Mainlayer = document.getElementById('Mainlayer'); 
    let ctxMain = Mainlayer.getContext('2d'); 
    function ImageObj(){
        this.bird=new Image();
        this.bullet= new Image();
        this.bird.src = "bird.png";
        this.bullet.src = "bullet.png";
    }
    ImageObj.prototype.init=function(x, y, width, height){
            this.x = x;
            this.y = y;
            this.width = width;
            this.height = height;
    }   
    let bird= new ImageObj();
    let YJump=0;
    let Jumping=false;
    let Dropping=true;
    let speed=1;
    let speedcount=1;
    bird.init(100,100,800,600)
    
    function dead(){
        ctxMain.drawImage(bird.bird,bird.x,bird.y)
    } 

    function jump(){
        ctxMain.clearRect(0, 0, 800, 600)
        if(Dropping==false){
        ctxMain.drawImage(bird.bird,bird.x,bird.y-=1)
        console.log("jump")
        }
        if(bird.y<YJump-40){
            Dropping=true;
            console.log("chuyen sang drop")
            drop()
            return;
        }
        window.requestAnimationFrame(jump);
       
    }
    function drop(){
        if(bird.y<115){
        //se thay the chuc nang kiem tra co cham mat dat khong sau
            if(Dropping==true){
                ctxMain.clearRect(0, 0, 800, 600)
                ctxMain.drawImage(bird.bird,bird.x,bird.y+=1)
            }
            else {
                return;
            }
        }
        else{
            window.requestAnimationFrame(dead)
        }
        console.log("drop" +Dropping+" bird "+bird.y)
        window.requestAnimationFrame(drop);
    }
    function whenPressSpace(){
        YJump=bird.y;
        if(Dropping==true){
        Dropping=false;
        speed++;
        jump();
        }   
            
     }
        
    
    window.addEventListener("keypress",whenPressSpace);  
     
    
    </script>
</body>
</html>